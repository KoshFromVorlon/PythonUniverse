import turtle

# =====================================================================
# 1. ИНФОРМАЦИЯ (Рекурсивный закон / "ДНК" растения)
# =====================================================================
axiom = "X"  # Начальное семечко

# Базовое правило (чертеж). Читается так:
# "Ветка X порождает ствол F, затем ветвится вправо и влево, создавая новые X"
rules = {
    "X": "F+[[X]-X]-F[-FX]+X",
    "F": "FF"
}


# =====================================================================
# 2. ВРЕМЯ (Итеративная "распаковка" чертежа клетками)
# =====================================================================
def grow_dna(state, iterations):
    """Каждая итерация - это условный 'год' роста дерева"""
    for _ in range(iterations):
        # Заменяем каждый символ по правилам из словаря
        state = "".join([rules.get(char, char) for char in state])
    return state


# Распаковываем ДНК на 7 итераций (лет).
# Из одного символа "X" строка разрастается до десятков тысяч команд!
dna_sequence = grow_dna(axiom, 6)

# =====================================================================
# 3. ФИЗИЧЕСКИЙ МИР (Отрисовка "материи" на экране)
# =====================================================================
turtle.Screen().bgcolor("black")
turtle.color("lightgreen")
turtle.speed(0)  # Максимальная скорость отрисовки
turtle.left(90)  # Дерево должно расти вверх, а не вбок
turtle.penup();
turtle.goto(0, -300);
turtle.pendown()  # Сдвигаем корень вниз экрана

stack = []  # Память для хранения узлов ветвления

print("Начинаю физический рост...")

# Процессор (природа) выполняет длинную цепочку команд шаг за шагом
for cmd in dna_sequence:
    if cmd == 'F':
        turtle.forward(4)  # Вырастить клетки ствола вперед
    elif cmd == '+':
        turtle.right(25)  # Наклон вправо (золотой угол)
    elif cmd == '-':
        turtle.left(25)  # Наклон влево
    elif cmd == '[':
        # Сохраняем текущие координаты и угол наклона (создаем почку)
        stack.append((turtle.pos(), turtle.heading()))
    elif cmd == ']':
        # Возвращаемся к последней почке, чтобы пустить боковую ветку
        pos, head = stack.pop()
        turtle.penup()
        turtle.goto(pos)
        turtle.setheading(head)
        turtle.pendown()

turtle.done()
